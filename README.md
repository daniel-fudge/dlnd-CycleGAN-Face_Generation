# dlnd-DCGAN-Face-Generation
This repo trains a Deep Convolutional Generative Adversarial Network (DCGAN) to generate faces.  The motivation for this 
program was the 5th project in the Udacity Deep Learning [Nanodegree](https://www.udacity.com/course/deep-learning-nanodegree--nd101). 

## How to run on AWS
This project can be executed directly from within the [dlnd_face_generation.ipynd](dlnd_face_generation.ipynb) Jupyter 
notebook.  Due to the time required to train the model, it is recommended that a GPU is used.  The output shown in the 
report and notebook were generated on AWS' Deep Learning AMI (Ubuntu 18.04) Version 26.0 with a p2.xlarge instance.

1. Launch your AWS instance and ssh into it.
   - Remember to add a "Custom TCP Rule" to your security group inbound rules to allow Jupyter notebooks.
   
   #### From AWS CLI
1. Configure Jupyter notebook  
   ```bash
   jupyter notebook --generate-config
   sed -ie "s/#c.NotebookApp.ip = 'localhost'/#c.NotebookApp.ip = '*'/g" ~/.jupyter/jupyter_notebook_config.py
   ```

1. Clone the repo.
   ```bash 
   git clone https://github.com/daniel-fudge/dlnd-DCGAN-Face-Generation.git```

1. Download the input files (you can replaces with your own files) and unzip.
   ```bash
   cd dlnd-DCGAN-Face-Generation
   wget https://s3.amazonaws.com/video.udacity-data.com/topher/2018/November/5be7eb6f_processed-celeba-small/processed-celeba-small.zip
   unzip processed-celeba-small.zip
   rm *.zip
   rm -r __MACOSX
   ```

1. Activate Python 3 environment with PyTorch, CUDA 10 and MKL-DNN.  Then install cv2.
   ```bash 
   source activate pytorch_p36
   conda install opencv```

1. Start Jupyter notebook
   ```bash   
   jupyter notebook --ip=0.0.0.0 --no-browser
   ``` 

1. Record the long URL generated by the previous command, it should have the format 
http://[some_ip]:8888/?token=[your_token].
   
   #### From your local PC
1. Connect to the notebook from your browser by replacing [some_ip] with your instances IPv4 Public IP.

1. Open `dlnd_face_generation.ipynb`.

1. Read and/or run the cells at your leisure!!  :)   

## How to run on Local PC   
Although it is not recommended to train on a local PC, you may want to run locally to debug.  

1. Clone repo to PC.
   ```shell script
   git clone https://github.com/daniel-fudge/dlnd-DCGAN-Face-Generation.git
   ```

1. Download [processed-celeba-small.zip](https://s3.amazonaws.com/video.udacity-data.com/topher/2018/November/5be7eb6f_processed-celeba-small/processed-celeba-small.zip) 
and unzip into dlnd-DCGAN-Face-Generation folder.

1. [OPTIONAL] Delete the zip file and any miscellaneous OS X files or folders such as `__MACOSX` or `.DS_Store`.  

1. [OPTIONAL] Install [Anaconda3](https://www.anaconda.com/distribution/).

1. [OPTIONAL] Create a virtual environment.
   ```shell script
   conda update conda
   conda create -n pytorch_p36 python=3.7 
   conda activate pytorch_p36
   conda install pytorch
   conda install -c pytorch torchvision
   conda install opencv
   conda install matplotlib
   conda install tqdm
   ```
   
1. [OPTIONAL] Activate the virtual environment.
   ```shell script
   conda activate pytorch_p36
   ```

1. Launch Jupyter.
   ```shell script
   cd dlnd-DCGAN-Face-Generation
   jupyter notebook
   ```

1. Open `dlnd_face_generation.ipynb`.

1. Read and/or run the cells at your leisure!!  :)
 
## Report
A [report](report.html) was generated from the [Jupyter Notebook](dlnd_face_generation.ipynb) for those who prefer html 
files.

## License
This code is copyright under the [MIT License](LICENSE).

## Contributions
Please feel free to raise issues against this repo if you have any questions or suggestions for improvement.